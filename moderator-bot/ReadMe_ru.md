# üõ°Ô∏è Mattermost Moderator Bot
–ë–æ—Ç-–º–æ–¥–µ—Ä–∞—Ç–æ—Ä –¥–ª—è Mattermost, –∫–æ—Ç–æ—Ä—ã–π –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–∏—Å–∞—Ç—å –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∫–∞–Ω–∞–ª–∞—Ö.  
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–Ω–µ —Å–ø–∏—Å–∫–∞ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö:
- ‚ùå –ù–µ –º–æ–≥—É—Ç –ø–∏—Å–∞—Ç—å –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∫–∞–Ω–∞–ª–µ
- ‚úÖ –ú–æ–≥—É—Ç –æ—Ç–≤–µ—á–∞—Ç—å –≤ —Ç—Ä–µ–¥–∞—Ö ‚Äî —Ç–æ–ª—å–∫–æ –≤ –∫–∞–Ω–∞–ª–∞—Ö, —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –≤ `THREAD_ALLOWLIST`
- üóëÔ∏è –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: *–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ—à—ë–ª –≤ –∫–∞–Ω–∞–ª*, *–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª–µ–Ω*) –º–æ–≥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—Ç—å—Å—è –≤ –∫–∞–Ω–∞–ª–∞—Ö –∏–∑ `SYSTEM_MESSAGE_DELETE`
- üì© –ü–æ–ª—É—á–∞—é—Ç –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–∏—á–∏–Ω–æ–π —É–¥–∞–ª–µ–Ω–∏—è, –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ `DM_NOTIFY`  

---
## üìú –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
–ë–æ—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∫–∞–Ω–∞–ª–æ–≤ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –∫–æ–º–∞–Ω–¥–µ.  
–í –∫–∞–∂–¥–æ–º –∫–∞–Ω–∞–ª–µ:
- –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è
- –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ allowlist ‚Äî —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Å—Ç–∞—ë—Ç—Å—è
- –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤ —Å–ø–∏—Å–∫–µ –∏ –ø–∏—à–µ—Ç –≤ –∫–∞–Ω–∞–ª ‚Üí —Å–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è
- –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤ —Å–ø–∏—Å–∫–µ –∏ –ø–∏—à–µ—Ç –≤ —Ç—Ä–µ–¥:
    - –∫–∞–Ω–∞–ª –µ—Å—Ç—å –≤ THREAD_ALLOWLIST ‚Üí —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Å—Ç–∞—ë—Ç—Å—è,
    - –∫–∞–Ω–∞–ª–∞ –Ω–µ—Ç –≤ THREAD_ALLOWLIST ‚Üí —Å–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è.
- –ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ DM_NOTIFY=yes, –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –õ–° —Å —Ç–µ–∫—Å—Ç–æ–º DM_TEXT.
- –µ—Å–ª–∏ –∫–∞–Ω–∞–ª –≤ `SYSTEM_MESSAGE_DELETE` ‚Üí –±–æ—Ç —É–¥–∞–ª—è–µ—Ç –≤—Å–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (`system_join_channel`, `system_add_to_channel` –∏ —Ç. –ø.)  

---
## üîß –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- mattermostdriver==7.3.2
- requests==2.28.2
- python-dotenv==1.0.1

---
## ‚ö†Ô∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏—è
- –ï—Å–ª–∏ Mattermost –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç, –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å `verify=False` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).  
  –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –≤ –ª–æ–≥–∞—Ö –º–æ–≥—É—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è `InsecureRequestWarning`. –û–Ω–∏ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã –∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–∫—Ä—ã—Ç—ã —Å–∞–º–∏–º –±–æ—Ç–æ–º.  
- –î–ª—è –±–æ–ª—å—à–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–π CA-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ —É–∫–∞–∑–∞—Ç—å `verify=/path/to/ca.crt` –≤–º–µ—Å—Ç–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ SSL.  
- –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–∞–Ω–∞–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω –±—É–¥–µ—Ç –º–æ–¥–µ—Ä–∏—Ä–æ–≤–∞—Ç—å.  
- –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ —Ñ–∞–π–ª `.env`.  

---
## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–æ–∑–¥–∞–π —Ñ–∞–π–ª .env (–Ω–∞ –æ—Å–Ω–æ–≤–µ .env.example):
```
MM_URL=mm.example.com
MM_SCHEME=https
MM_PORT=443
MM_TOKEN=your-bot-token
TEAM_NAME=your-team

CHANNEL_ALLOWLIST=test:@admin1,@admin2;general:@moderator
GLOBAL_ALLOWLIST=@superadmin
THREAD_ALLOWLIST=test,dev-chat
SYSTEM_MESSAGE_DELETE=test,general

DM_NOTIFY=yes
DM_TEXT=–í —ç—Ç–æ–º –∫–∞–Ω–∞–ª–µ –ø–∏—Å–∞—Ç—å –º–æ–≥—É—Ç —Ç–æ–ª—å–∫–æ –¥–æ–ø—É—â–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏. –ö–∞–Ω–∞–ª: {channel}
```

---
## üóíÔ∏è –ö–∞–Ω–∞–ª—ã –∏ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
**–§–æ—Ä–º–∞—Ç: channel1:@user1,@user2;channel2:@user3**  
CHANNEL_ALLOWLIST=test:@admin1,@admin2;general:@moderator
**–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–º –≤–µ–∑–¥–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ**  
GLOBAL_ALLOWLIST=@superadmin
**–ö–∞–Ω–∞–ª—ã, –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –æ—Ç–≤–µ—á–∞—Ç—å –≤ —Ç—Ä–µ–¥—ã**  
THREAD_ALLOWLIST=test,dev-chat
**–ö–∞–Ω–∞–ª—ã, –≥–¥–µ –±—É–¥—É—Ç —É–¥–∞–ª—è—Ç—å—Å—è —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è**
SYSTEM_MESSAGE_DELETE=test,general
**–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –õ–°**  
DM_NOTIFY=yes  
DM_TEXT=–í —ç—Ç–æ–º –∫–∞–Ω–∞–ª–µ –ø–∏—Å–∞—Ç—å –º–æ–≥—É—Ç —Ç–æ–ª—å–∫–æ –¥–æ–ø—É—â–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏. –ö–∞–Ω–∞–ª: {channel}  

---
## üöÄ –ó–∞–ø—É—Å–∫
1. –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –≤ Docker
```bash
docker build -t mm-moderator-bot .
docker run -d --restart=always --env-file .env mm-moderator-bot
```

---
## üë§ –ê–≤—Ç–æ—Ä
**–ú–∏–∫–æ—à–∏ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä**  
–≠–∫–æ—Å–∏—Å—Ç–µ–º–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ **–ú2**